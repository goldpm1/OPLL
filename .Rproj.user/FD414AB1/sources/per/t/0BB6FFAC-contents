setwd ("/home/goldpm1/Meningioma/script/31.Clonality")
find.package("MutationTimeR")
library("MutationTimeR")
library("GenomicRanges")
library("vcfR")

# INPUT_DF
SEQUENZA_SEGMENT_PATH="/home/goldpm1/Meningioma/11.cnv/2.sequenza/220930_Dura_segments.txt"
SEQUENZA_PLOIDY_PATH="/home/goldpm1/Meningioma/11.cnv/2.sequenza/220930_Dura_confints_CP.txt"
MUTECT_RESCUE_PATH="/home/goldpm1/Meningioma/04.mutect/04.rescue/220930_Dura.MT2.FMC.HF.RMBLACK.vep.rescue.vcf"
HC_PATH="/home/goldpm1/Meningioma/06.hc/03.HF/220930/Dura/220930_Dura.DP100.vcf"

ploidy_df = read.table ( SEQUENZA_PLOIDY_PATH, header = T, sep = "\t")
TUMOR_PURITY = ploidy_df[1,"cellularity"]

df = read.table (SEQUENZA_SEGMENT_PATH, header = T, sep = "\t")


# Create a GRange object
gr = GRanges(seqnames = df$chromosome, ranges = IRanges (df$start.pos, df$end.pos), strand = rep("*", nrow(df)),
             major_cn = df$A, minor_cn = df$B, 
             clonal_frequency = TUMOR_PURITY )

meningioma_vcf = VariantAnnotation::readVcf( HC_PATH )
alz_vcf = VariantAnnotation::readVcf( "/data/project/Alzheimer/Main/00.Neurogenesis/03.variant/Mutect2/01.MT2/temp.vcf" )
#my_vcf = read.vcfR ( MUTECT_RESCUE_PATH ) 
clusters = data.frame(cluster = 1, proportion=TUMOR_PURITY,n_ssms=100)
mt = MutationTimeR::mutationTime(meningioma_vcf, gr, n.boot=10)


df = read.table ("/home/goldpm1/Meningioma/31.Clonality/03.mutationtimeR/SeYoung/P26_tumor.RGadded.marked.fixed.small.seqz_segments.txt", header = T, sp





# cn <- MutationTimeR:::refLengths[1:nrow(df)]
# MutationTimeR:::simulateMutations(cn, rho=0.01, n=40)


# Create a vcfR object
data(MutationTimeR)
#options(bitmapType=”cairo”)
mt = mutationTime(vcf, bb, clusters=clusters, n.boot=10)
vcf = addMutTime(vcf, mt$V)
mcols(bb) = cbind(mcols(bb), mt$T)
plotSample (vcf,bb)
